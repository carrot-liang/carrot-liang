import{_ as i,c as e,a,o as t}from"./app-CfU1feWq.js";const h="/assets/1-CuWNML-8.png",l="/assets/2-xme2IgFT.png",n="/assets/3-CCPGWYgs.png",d={};function r(p,s){return t(),e("div",null,[...s[0]||(s[0]=[a(`<h2 id="一、连接ssh" tabindex="-1"><a class="header-anchor" href="#一、连接ssh"><span>一、连接SSH</span></a></h2><p>首先，通过 SSH 连接到 VM。以下示例使用用户名连接到 x.x.x.x 的 VM。</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">ssh</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> root@x.x.x.x</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h2 id="二、安装-xfce" tabindex="-1"><a class="header-anchor" href="#二、安装-xfce"><span>二、安装 xfce</span></a></h2><p>先确认是否已有桌面环境</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">ls</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /usr/share/xsessions</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>若无法找到，可使用 apt 安装 xfce：</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">sudo</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> apt-get</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> update</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">sudo</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> apt</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> install</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> xfce4</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> xfce4-goodies</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="三、安装-xrdp" tabindex="-1"><a class="header-anchor" href="#三、安装-xrdp"><span>三、安装 xrdp</span></a></h2><p>使用 apt 安装 xrdp：</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">sudo</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> apt</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> update</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">sudo</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> apt</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> install</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> xrdp</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>安装完成后，你可以通过输入 <code>xrdp --version</code> 来检查 xrdp 是否成功安装。</p><h2 id="四、配置-xrdp" tabindex="-1"><a class="header-anchor" href="#四、配置-xrdp"><span>四、配置 xrdp</span></a></h2><p>xrdp 的配置文件位于 <code>/etc/xrdp/xrdp.ini</code>。</p><p>xrdp 使用的默认会话管理器 sesman 的配置文件位于 <code>/etc/xrdp/sesman.ini</code></p><p>修改配置 XRDP 服务器的脚本文件：</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">sudo</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> vim</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /etc/xrdp/startwm.sh</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>注释原有 test 行和 exec 行，增加 startxfce4</p><img src="`+h+`"><h2 id="五、启动-xrdp-服务" tabindex="-1"><a class="header-anchor" href="#五、启动-xrdp-服务"><span>五、启动 xrdp 服务</span></a></h2><p>安装和配置完成后，就可以启动 xrdp 服务了。在终端中输入以下命令启动服务：</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">sudo</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> systemctl</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> start</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> xrdp</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>如果你想让 xrdp 在系统启动时自动运行，可以使用以下命令设置开机自启：</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">sudo</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> systemctl</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> enable</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> xrdp</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>修改配置文件后，重启服务可使用如下命令：</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">sudo</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> systemctl</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> restart</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> xrdp</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="设置本地用户帐户密码" tabindex="-1"><a class="header-anchor" href="#设置本地用户帐户密码"><span>设置本地用户帐户密码</span></a></h3><p>xrdp 无法接受使用 SSH 密钥进行身份验证。如果在创建 VM 时已为用户帐户创建密码，请跳过此步骤。如果仅使用 SSH 密钥身份验证，请使用如下命令指定用户的密码。</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">sudo</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> passwd</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> root</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h2 id="六、远程连接" tabindex="-1"><a class="header-anchor" href="#六、远程连接"><span>六、远程连接</span></a></h2><p>使用任何支持 RDP 协议的远程桌面客户端（如 Windows 的远程桌面连接、Mac 的 Windows App 等）来连接服务器。</p><p>在客户端中输入服务器的 IP 地址和端口号（默认为 3389），点击连接。</p><h2 id="七、故障排除" tabindex="-1"><a class="header-anchor" href="#七、故障排除"><span>七、故障排除</span></a></h2><h3 id="无法连接" tabindex="-1"><a class="header-anchor" href="#无法连接"><span>无法连接</span></a></h3><p>如果无法使用远程桌面客户端连接到 Linux VM，请在 Linux VM 上使用 netstat 验证 VM 是否正在侦听 RDP 连接，如下所示：</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">sudo</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> netstat</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -plnt</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> |</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> grep</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> rdp</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>以下示例显示正在按预期方式侦听 TCP 端口 3389 的 VM：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-"><span class="line"><span>tcp     0     0      127.0.0.1:3350     0.0.0.0:*     LISTEN     53192/xrdp-sesman</span></span>
<span class="line"><span>tcp     0     0      0.0.0.0:3389       0.0.0.0:*     LISTEN     53188/xrdp</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>如果 xrdp-sesman 服务未在侦听，请在 Ubuntu VM 上重新启动该服务，如下所示：</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">sudo</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> systemctl</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> restart</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> xrdp</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>可查看 Ubuntu VM 上的 <code>/var/log/syslog</code> 中的日志：</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">tail</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -f</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /var/log/syslog</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="连接黑屏或响应缓慢" tabindex="-1"><a class="header-anchor" href="#连接黑屏或响应缓慢"><span>连接黑屏或响应缓慢</span></a></h3><p>有可能是网速问题，稍等一会就可以显示。可以通过如下方法降低显示质量，减少数据传输，提升连接稳定性</p><ol><li><p>在远程终端中设置xrdp.ini，将 max_bpp=32 改为 max_bpp=16</p></li><li><p>在rdp客户端中手动设置降低的分辨率，设置颜色质量 <img src="`+l+'"></p></li></ol><p>如果仍遇到黑屏问题，可能是因为本地会话没有注销。在 Ubuntu 上注销当前用户，然后重新连接即可解决。</p><h3 id="远程桌面中终端无法打开" tabindex="-1"><a class="header-anchor" href="#远程桌面中终端无法打开"><span>远程桌面中终端无法打开</span></a></h3><ol><li><p>点击左上角&quot;Application - Settings - Default Applications&quot; <img src="'+n+'"></p></li><li><p>在&quot;Utilities&quot;选项中，将&quot;Terminal Emulator&quot;改为&quot;Xfce Terminal&quot;</p></li><li><p>然后重启远程桌面链接，再进入即可正常打开终端</p></li></ol><h3 id="远程桌面中无法打开浏览器" tabindex="-1"><a class="header-anchor" href="#远程桌面中无法打开浏览器"><span>远程桌面中无法打开浏览器</span></a></h3><ol><li>使用终端安装浏览器</li></ol><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">    sudo</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> apt</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> install</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> firefox</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ol start="2"><li>点击左上角&quot;Application - Settings - Default Applications&quot;，设置默认浏览器</li></ol><h2 id="参考资料" tabindex="-1"><a class="header-anchor" href="#参考资料"><span>参考资料</span></a></h2><ul><li>https://learn.microsoft.com/zh-cn/azure/virtual-machines/linux/use-remote-desktop?tabs=azure-cli</li><li>https://developer.baidu.com/article/details/3281932</li><li>https://cloud.baidu.com/article/3281923</li><li>https://blog.csdn.net/2301_76459044/article/details/147031270</li></ul>',54)])])}const c=i(d,[["render",r]]),g=JSON.parse('{"path":"/article/h6uqtpmr/","title":"Ubuntu 安装桌面环境（xfce）并开启远程连接（xrdp）","lang":"zh-CN","frontmatter":{"title":"Ubuntu 安装桌面环境（xfce）并开启远程连接（xrdp）","createTime":"2025/08/07","permalink":"/article/h6uqtpmr/","description":"一、连接SSH 首先，通过 SSH 连接到 VM。以下示例使用用户名连接到 x.x.x.x 的 VM。 二、安装 xfce 先确认是否已有桌面环境 若无法找到，可使用 apt 安装 xfce： 三、安装 xrdp 使用 apt 安装 xrdp： 安装完成后，你可以通过输入 xrdp --version 来检查 xrdp 是否成功安装。 四、配置 xrd...","head":[["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"Ubuntu 安装桌面环境（xfce）并开启远程连接（xrdp）\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2025-09-05T02:50:33.000Z\\",\\"author\\":[]}"],["meta",{"property":"og:url","content":"https://wwww.growcarrot.tech/article/h6uqtpmr/"}],["meta",{"property":"og:site_name","content":"Grow Carrot Tech"}],["meta",{"property":"og:title","content":"Ubuntu 安装桌面环境（xfce）并开启远程连接（xrdp）"}],["meta",{"property":"og:description","content":"一、连接SSH 首先，通过 SSH 连接到 VM。以下示例使用用户名连接到 x.x.x.x 的 VM。 二、安装 xfce 先确认是否已有桌面环境 若无法找到，可使用 apt 安装 xfce： 三、安装 xrdp 使用 apt 安装 xrdp： 安装完成后，你可以通过输入 xrdp --version 来检查 xrdp 是否成功安装。 四、配置 xrd..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2025-09-05T02:50:33.000Z"}],["meta",{"property":"article:modified_time","content":"2025-09-05T02:50:33.000Z"}]]},"git":{"createdTime":1757040633000,"updatedTime":1757040633000},"autoDesc":true,"filePathRelative":"笔记/ubuntu_xfce_rdp.md","headers":[],"categoryList":[{"id":"7051dc","sort":10001,"name":"笔记"}]}');export{c as comp,g as data};
